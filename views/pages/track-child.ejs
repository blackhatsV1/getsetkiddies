<%- include('../partials/head') %>
<body>
  <%- include('../partials/top-nav-parents') %>

  <div class="main-container">
    <%- include('../partials/side-nav-parents') %>

    <main class="content">
      <% if (parent) { %>
        <p>Logged in as: <strong><%= parent.firstname %> <%= parent.lastname %></strong></p>
      <% } %>

      <h3>Registered Children</h3>

      <% if (children.length === 0) { %>
        <p>No registered children found.</p>
      <% } else { %>
        <table border="1" id="childrenTable" style="width: 100%; border-collapse: collapse;">
          <thead>
            <tr>
              <th>Firstname</th>
              <th>Lastname</th>
              <th>Age</th>
              <th>Gender</th>
              <th>Last Seen Location</th>
              <th>Action</th>
            </tr>
          </thead>
          <tbody>
            <% children.forEach(child => { %>
              <tr data-child-id="<%= child.id %>">
                <td><%= child.firstname %></td>
                <td><%= child.lastname %></td>
                <td><%= child.child_age %></td>
                <td><%= child.child_gender %></td>
                <td class="last-location">Loading...</td>
                <td>
                  <button class="trackBtn"
                    data-child-id="<%= child.id %>"
                    data-child-name="<%= child.firstname %>">
                    Show on Map
                  </button>
                </td>
              </tr>
            <% }) %>
          </tbody>
        </table>
      <% } %>

      <!-- Map and live tracking -->
      <%- include('../partials/locationselect') %>

    </main>
  </div>

  <%- include('../partials/footer') %>
  <script src="/js/locationselect.js"></script>
</body>
